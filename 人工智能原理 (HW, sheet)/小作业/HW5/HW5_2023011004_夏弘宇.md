# äººå·¥æ™ºèƒ½åŸç†-ä½œä¸š5

#### Author: å¤å¼˜å®‡ 2023011004

## T1

### é—®é¢˜æè¿°

- è€ƒè™‘å«ä¸¤ç»„éšå±‚å•å…ƒçš„ä¸‰å±‚å‰é¦ˆç¥ç»ç½‘ç»œï¼š
  
  <img title="" src="image.png" alt="ç¬¬ä¸€é¢˜å›¾" data-align="center" width="370">

$$
W_1 = \begin{bmatrix}
0.1 & 0.1 & 0.3 \\
0.2 & 0.3 & 0.2 \\
0.1 & 0.2 & 0.1 \\
0.3 & 0.1 & 0.1
\end{bmatrix}, \quad
W_2 = W_1^T, \quad
W_3 = \begin{bmatrix} 0.2 & 0.2 & 0.4 \end{bmatrix}
$$

$$
[b_1, b_2, b_3] = [0.5, 0.5, 0.2]
$$

å„å‚æ•°çš„åˆå§‹å€¼å¦‚ä¸Šæ‰€ç¤ºã€‚å®šä¹‰è¯¥ç½‘ç»œçš„éšè—å±‚å•å…ƒçš„æ¿€æ´»å‡½æ•°ä¸º â„=cos(ğ‘§) ï¼Œè¾“å‡ºå•å…ƒä¸º
Logistic å‡½æ•°ã€‚

### T1-1

- Q: å½“è¾“å…¥ä¸º $(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3) = (0.05,0.10,0.05)$ æ—¶ï¼Œè®¡ç®—è¯¥ç¥ç»ç½‘ç»œè¾“å‡º ğ‘¦ çš„å€¼ã€‚è¯·å†™æ˜å¿…è¦çš„è®¡ç®—è¿‡ç¨‹ã€‚
- A:

**è¾“å…¥å‘é‡**  


$$
x = \begin{bmatrix} 0.05 \\ 0.10 \\ 0.05 \end{bmatrix}
$$



**ç¬¬ä¸€éšè—å±‚è®¡ç®—**

- **æƒé‡çŸ©é˜µ** $W_1$ å’Œ **åç½®** $b_1=0.5$ï¼š
  
  $$
  W_1 = \begin{bmatrix}
0.1 & 0.1 & 0.3 \\
0.2 & 0.3 & 0.2 \\
0.1 & 0.2 & 0.1 \\
0.3 & 0.1 & 0.1
\end{bmatrix}, \quad
b_1 = 0.5
  $$

- **çº¿æ€§ç»„åˆ** $z_1 = W_1 \cdot x + b_1$ï¼š
  
  $$
  \begin{aligned}
z_1 &= \begin{bmatrix}
0.1 \cdot 0.05 + 0.1 \cdot 0.10 + 0.3 \cdot 0.05 \\
0.2 \cdot 0.05 + 0.3 \cdot 0.10 + 0.2 \cdot 0.05 \\
0.1 \cdot 0.05 + 0.2 \cdot 0.10 + 0.1 \cdot 0.05 \\
0.3 \cdot 0.05 + 0.1 \cdot 0.10 + 0.1 \cdot 0.05
\end{bmatrix} + 0.5 \\
&= \begin{bmatrix}
0.005 + 0.010 + 0.015 \\
0.010 + 0.030 + 0.010 \\
0.005 + 0.020 + 0.005 \\
0.015 + 0.010 + 0.005
\end{bmatrix} + 0.5 \\
&= \begin{bmatrix} 0.03 \\ 0.05 \\ 0.03 \\ 0.03 \end{bmatrix} + 0.5 = \begin{bmatrix} 0.53 \\ 0.55 \\ 0.53 \\ 0.53 \end{bmatrix}
\end{aligned}
  $$

- **æ¿€æ´»å‡½æ•°** $a_1 = \cos(z_1)$ï¼š
  
  $$
  a_1 = \begin{bmatrix}
\cos(0.53) \\
\cos(0.55) \\
\cos(0.53) \\
\cos(0.53)
\end{bmatrix} \approx \begin{bmatrix} 0.862 \\ 0.853 \\ 0.862 \\ 0.862 \end{bmatrix}
  $$

**ç¬¬äºŒéšè—å±‚è®¡ç®—**

- **æƒé‡çŸ©é˜µ** $W_2 = W_1^T$ å’Œ **åç½®** $b_2=0.5$ï¼š
  
  $$
  W_2 = \begin{bmatrix}
0.1 & 0.2 & 0.1 & 0.3 \\
0.1 & 0.3 & 0.2 & 0.1 \\
0.3 & 0.2 & 0.1 & 0.1
\end{bmatrix}, \quad
b_2 = 0.5
  $$

- **çº¿æ€§ç»„åˆ** $z_2 = W_2 \cdot a_1 + b_2$ï¼š
  
  $$
  \begin{aligned}
z_2 &= \begin{bmatrix}
0.1 \cdot 0.862 + 0.2 \cdot 0.853 + 0.1 \cdot 0.862 + 0.3 \cdot 0.862 \\
0.1 \cdot 0.862 + 0.3 \cdot 0.853 + 0.2 \cdot 0.862 + 0.1 \cdot 0.862 \\
0.3 \cdot 0.862 + 0.2 \cdot 0.853 + 0.1 \cdot 0.862 + 0.1 \cdot 0.862
\end{bmatrix} + 0.5 \\
&= \begin{bmatrix}
0.0862 + 0.1706 + 0.0862 + 0.2586 \\
0.0862 + 0.2559 + 0.1724 + 0.0862 \\
0.2586 + 0.1706 + 0.0862 + 0.0862
\end{bmatrix} + 0.5 \\
&= \begin{bmatrix} 0.6016 \\ 0.6007 \\ 0.6016 \end{bmatrix} + 0.5 = \begin{bmatrix} 1.102 \\ 1.101 \\ 1.102 \end{bmatrix}
\end{aligned}
  $$

- **æ¿€æ´»å‡½æ•°** $a_2 = \cos(z_2)$ï¼š
  
  $$
  a_2 = \begin{bmatrix}
\cos(1.102) \\
\cos(1.101) \\
\cos(1.102)
\end{bmatrix} \approx \begin{bmatrix} 0.452 \\ 0.453 \\ 0.452 \end{bmatrix}
  $$

**è¾“å‡ºå±‚è®¡ç®—**

- **æƒé‡çŸ©é˜µ** $W_3$ å’Œ **åç½®** $b_3=0.2$ï¼š
  
  $$
  W_3 = \begin{bmatrix} 0.2 & 0.2 & 0.4 \end{bmatrix}, \quad
b_3 = 0.2
  $$

- **çº¿æ€§ç»„åˆ** $z_3 = W_3 \cdot a_2 + b_3$ï¼š
  
  $$
  \begin{aligned}
z_3 &= 0.2 \cdot 0.452 + 0.2 \cdot 0.453 + 0.4 \cdot 0.452 + 0.2 \\
&= 0.0904 + 0.0906 + 0.1808 + 0.2 \\
&= 0.562
\end{aligned}
  $$

- **Logistic å‡½æ•°** $\sigma(z_3) = \frac{1}{1 + e^{-z_3}}$ï¼š
  
  $$
  \sigma(0.562) = \frac{1}{1 + e^{-0.562}} \approx \frac{1}{1 + 0.570} \approx 0.637
  $$

**æœ€ç»ˆè¾“å‡º**  

$$
\hat{y} \approx 0.637
$$



### T1-2

- Q: åœ¨T1-1çš„åŸºç¡€ä¸Šï¼Œè‹¥ğ‘¦=0.95ï¼Œé‡‡ç”¨æœ€å°åŒ–å‡æ–¹è¯¯å·®ä½œä¸ºä¼˜åŒ–å‡†åˆ™ï¼Œè¯·æ ¹æ®BPç®—æ³•è®¡ç®—å‚æ•°$ğ‘Š_3$çš„æ¢¯åº¦ã€‚

- A:
1. **è¾“å‡ºå±‚è¯¯å·®è®¡ç®—**  
   å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°ï¼šï¼ˆé—®äº†ç‹å­å®‰åŠ©æ•™ï¼Œç­”æ›°ç³»æ•°ä¸è¦ç´§ï¼Œæ•…æŒ‰ç…§è‡ªå·±ä¹‹å‰å­¦çš„ä¹˜äº†äºŒåˆ†ä¹‹ä¸€ï¼‰
   
   $$
   E = \frac{1}{2}(\hat{y} - y)^2
   $$
   
   Logisticå‡½æ•°å¯¼æ•°ï¼š
   
   $$
   \sigma'(z_3) = \sigma(z_3)(1-\sigma(z_3)) = \hat{y}(1-\hat{y})
   $$
   
   è¾“å‡ºå±‚è¯¯å·®é¡¹ï¼š
   
   $$
   \delta_3 = \frac{\partial E}{\partial z_3} = (\hat{y} - y) \cdot \sigma'(z_3) = (0.637 - 0.95) \times 0.637 \times (1-0.637)
   $$
   
   $$
   = (-0.313) \times 0.637 \times 0.363 \approx -0.0724
   $$

2. **$W_3$ æ¢¯åº¦è®¡ç®—**  
   
   $$
   \frac{\partial E}{\partial W_3} = \frac{\partial E}{\partial z_3} \cdot \frac{\partial z_3}{\partial W_3} = \delta_3 \cdot a_2^T = -0.0724 \times \begin{bmatrix} 0.452 & 0.453 & 0.452 \end{bmatrix}
   $$
   
   $$
   \approx \begin{bmatrix} -0.0327 & -0.0328 & -0.0327 \end{bmatrix}
   $$

3. **æ¢¯åº¦ç»“æœ**  
   $W_3$ çš„æ¢¯åº¦ä¸ºï¼š
   
   $$
   \nabla W_3 = \begin{bmatrix} -0.0327 & -0.0328 & -0.0327 \end{bmatrix}
   $$

### T1-3

- Q: åœ¨T1-2çš„åŸºç¡€ä¸Šï¼Œè‹¥é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°ï¼Œä¸”å­¦ä¹ ç‡è®¾ç½®ä¸º0.1ï¼Œå†™å‡ºæ›´æ–°åçš„å‚æ•°$ğ‘Š_3$ã€‚

- A:
  
  $$
  W_3^{new} = W_3 - \eta \cdot \nabla W_3\\\
 \begin{aligned}
 w_{3,1}^{new} &= 0.2 - 0.1 \times (-0.0327) \approx 0.2033 \\
 w_{3,2}^{new} &= 0.2 - 0.1 \times (-0.0328) \approx 0.2033 \\
 w_{3,3}^{new} &= 0.4 - 0.1 \times (-0.0327) \approx 0.4033 
\end{aligned}\\\
 W_3^{new} = \begin{bmatrix} 0.2033 & 0.2033 & 0.4033 \end{bmatrix}
  $$
  
  

## T4

### é—®é¢˜æè¿°

å°è¯•å¯¹å•ä¸ªæ—¶é—´æ­¥çš„LSTMç½‘ç»œè¿›è¡Œæƒå€¼æ›´æ–°ã€‚å·²çŸ¥è¾“å…¥å€¼x<sub>t</sub>ã€ä¸Šä¸€æ—¶åˆ»çš„è¾“å‡ºçŠ¶æ€
h<sub>t-1</sub>ã€è®°å¿†çŠ¶æ€C<sub>t-1</sub>ã€åˆå§‹å‚æ•°å‘é‡Î¸<sub>0</sub>ï¼ˆåŒ…æ‹¬è¾“å…¥é—¨i<sub>t</sub>ã€é—å¿˜é—¨f<sub>t</sub>ã€è¾“å‡ºé—¨o<sub>t</sub>ã€å€™é€‰è®°å¿†
CÌƒ<sub>t</sub>ç­‰é—¨æ§å•å…ƒçš„æƒé‡çŸ©é˜µWï¼‰å’Œç†è®ºè¾“å‡ºå€¼dåˆ†åˆ«ä¸ºï¼š

- è¾“å…¥å€¼x<sub>t</sub> = [1]
- ä¸Šä¸€æ—¶åˆ»çš„è¾“å‡ºçŠ¶æ€h<sub>t-1</sub> = [0]ï¼Œè®°å¿†çŠ¶æ€C<sub>t-1</sub> = [0]
- åˆå§‹å‚æ•°W<sub>f</sub> = [0.5,0.5]ï¼ŒW<sub>i</sub> = [0.4,0.4]ï¼ŒW<sub>o</sub> = [0.5,0.5]ï¼ŒW<sub>C</sub> = [0.4,0.4]ï¼Œä¸è€ƒè™‘åç½®é¡¹
- ç†è®ºè¾“å‡ºå€¼d = 0.6

<img title="" src="image-1.png" alt="ç¬¬å››é¢˜å›¾" data-align="center" width="395">

### T4-1

Q: æ ‡å‡†LSTMå•å…ƒå¦‚å›¾æ‰€ç¤ºï¼Œå…¶ä¸­Ïƒä»£è¡¨Sigmoidå‡½æ•°ï¼Œè¯·ä½ æ ¹æ®å¦‚ä¸‹å…¬å¼è¿›è¡Œå‰å‘ä¼ æ’­ï¼Œè®¡ç®—è¾“å‡ºå€¼h<sub>t</sub>å’Œè®°å¿†çŠ¶æ€$C_t$ã€‚

$$
\begin{aligned}
f_t &= \sigma(\textbf{W}_f \times [\textbf{h}_{t-1}, \textbf{x}_t]) \\
i_t &= \sigma(\textbf{W}_i \times [\textbf{h}_{t-1}, \textbf{x}_t]) \\
\tilde{\textbf{C}}_t &= \tanh(\textbf{W}_C \times [\textbf{h}_{t-1}, \textbf{x}_t]) \\
o_t &= \sigma(\textbf{W}_o \times [\textbf{h}_{t-1}, \textbf{x}_t]) \\
\textbf{C}_t &= f_t \times \textbf{C}_{t-1} + i_t \times \tilde{\textbf{C}}_t \\
\textbf{h}_t &= o_t \times \tanh(\textbf{C}_t)
\end{aligned}
$$

A:

$$
[h_{t-1}, x_t] = [0, 1]\\
 
 
 f_t = \sigma(0.5 \times 0 + 0.5 \times 1) = 0.6225\\
 
 
 i_t = \sigma(0.4 \times 0 + 0.4 \times 1) = 0.5987\\
 
 
 \tilde{C}_t = \tanh(0.4 \times 0 + 0.4 \times 1) = 0.3799\\
 
 
 C_t = 0.6225 \times 0 + 0.5987 \times 0.3799 = 0.2274\\
 
 
 o_t = \sigma(0.5 \times 0 + 0.5 \times 1) = 0.6225\\
 
 
 h_t = 0.6225 \times \tanh(0.2274) = 0.1393
$$


   $$
   
   $$

### T4-2

Q: å‡è®¾æŸå¤±å‡½æ•°ä¸º$L = \frac{1}{2}(y - d)^2$ï¼Œ
å­¦ä¹ ç‡ä¸ºÎ± = 0.1ï¼Œå…¶ä¸­yä»£è¡¨å½“å‰æ—¶é—´æ­¥çš„ç½‘ç»œè¾“å‡ºï¼Œå³h<sub>t</sub>ï¼Œè¯·ä½ è¿›è¡Œåå‘ä¼ æ’­æ›´æ–°$ğ‘Š_ğ‘œ$çš„æƒé‡ã€‚

A:

$$
\frac{\partial L}{\partial h_t} = h_t - d = 0.1393 - 0.6000 = -0.4607\\
\frac{\partial h_t}{\partial o_t} = \tanh(C_t) = 0.2237\\
\frac{\partial o_t}{\partial z_o} = o_t(1-o_t) = 0.2350\\
\frac{\partial L}{\partial W_o} = \begin{bmatrix}
 0 \\ 
-0.4607 \times 0.2237 \times 0.2350 \times 1
 \end{bmatrix} = \begin{bmatrix} 0 \\ -0.0242 \end{bmatrix}\\
 W_o^{\text{new}} = \begin{bmatrix} 0.5000 \\ 0.5000 \end{bmatrix} - 0.1 \times \begin{bmatrix} 0 \\ -0.0242 \end{bmatrix} = \begin{bmatrix} 0.5000 \\ 0.5024 \end{bmatrix}
$$






   